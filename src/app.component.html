
<main class="min-h-screen container mx-auto p-4 md:p-8 flex flex-col">
  <header class="text-center mb-8">
    <h1 class="text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-sky-400 to-indigo-500">
      HDL AI Assistant
    </h1>
    <p class="text-slate-400 mt-2">Generate & Verify Digital Designs with AI</p>
  </header>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-8 flex-grow">
    <!-- LEFT PANEL: CONFIGURATION -->
    <div class="bg-slate-800/50 rounded-lg p-6 flex flex-col border border-slate-700">
      <h2 class="text-2xl font-semibold mb-4 text-sky-400">Design Specification</h2>
      
      <div class="flex-grow flex flex-col gap-6">
        <div>
          <label for="description" class="block text-sm font-medium text-slate-300 mb-2">
            Functional Description
          </label>
          <textarea
            id="description"
            rows="8"
            [ngModel]="description()"
            (ngModelChange)="description.set($event)"
            placeholder="Describe the functionality, interfaces, and performance requirements..."
            class="w-full bg-slate-900 border border-slate-700 rounded-md p-3 text-slate-200 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200"
          ></textarea>
        </div>

        <div>
          <label for="hdl-language" class="block text-sm font-medium text-slate-300 mb-2">
            Target RTL Language
          </label>
          <select 
            id="hdl-language"
            [ngModel]="hdlLanguage()"
            (ngModelChange)="hdlLanguage.set($event)"
            class="w-full bg-slate-900 border border-slate-700 rounded-md p-3 text-slate-200 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200"
          >
            <option value="Verilog">Verilog</option>
            <option value="VHDL">VHDL</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-300 mb-2">Output Deliverables</label>
          <div class="grid grid-cols-2 gap-3">
            @for(deliverable of deliverables(); track deliverable.id; let i = $index) {
              <button
                (click)="toggleDeliverable(i)"
                [class]="'p-3 rounded-md text-left transition-colors duration-200 ' + (deliverable.checked ? 'bg-indigo-600 text-white' : 'bg-slate-700 hover:bg-slate-600')"
              >
                <span class="font-medium">{{ deliverable.name }}</span>
              </button>
            }
          </div>
        </div>
      </div>

      <button
        (click)="generate()"
        [disabled]="isLoading() || !description().trim() || selectedDeliverables().length === 0"
        class="mt-8 w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-md hover:bg-indigo-500 transition duration-200 disabled:bg-slate-600 disabled:cursor-not-allowed flex items-center justify-center gap-2"
      >
        @if (isLoading()) {
          <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <span>Generating...</span>
        } @else {
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v2a2 2 0 01-2 2H7a2 2 0 01-2-2V4zm2 2v1h6V6H7zm6 5H7a1 1 0 000 2h6a1 1 0 000-2zm-3 3H7a1 1 0 000 2h3a1 1 0 000-2z" />
            <path d="M3 9a2 2 0 012-2h10a2 2 0 012 2v7a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
          </svg>
          <span>Generate</span>
        }
      </button>
    </div>

    <!-- RIGHT PANEL: OUTPUT -->
    <div class="bg-slate-800/50 rounded-lg p-1 md:p-2 flex flex-col border border-slate-700 overflow-hidden">
      @if (isLoading()) {
        <div class="flex flex-col items-center justify-center h-full text-center p-6">
          <svg class="animate-spin h-12 w-12 text-indigo-400 mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <h3 class="text-xl font-semibold text-slate-200">AI is thinking...</h3>
          <p class="text-slate-400 mt-2">{{ loadingMessage() }}</p>
        </div>
      } @else if (error()) {
        <div class="flex flex-col items-center justify-center h-full text-center p-6 bg-red-900/20">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-red-400 mb-4" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
          </svg>
          <h3 class="text-xl font-semibold text-red-300">An Error Occurred</h3>
          <p class="text-red-400 mt-2 text-sm max-w-md">{{ error() }}</p>
        </div>
      } @else if (generatedOutput()) {
        <div class="flex flex-col h-full">
          <div class="flex-shrink-0 border-b border-slate-700 px-2">
            <nav class="-mb-px flex space-x-2" aria-label="Tabs">
              @for (file of outputFiles(); track file.key) {
                <button
                  (click)="setActiveTab(file.key)"
                  [class]="'whitespace-nowrap py-3 px-4 border-b-2 font-medium text-sm transition-colors ' + (activeTab() === file.key ? 'border-indigo-500 text-indigo-400' : 'border-transparent text-slate-400 hover:text-slate-200 hover:border-slate-500')"
                >
                  {{ file.filename }}
                </button>
              }
            </nav>
          </div>
          <div class="flex-grow overflow-y-auto">
            @for (file of outputFiles(); track file.key) {
              @if (activeTab() === file.key) {
                <app-code-display [filename]="file.filename" [language]="file.language" [code]="file.code" />
              }
            }
          </div>
        </div>
      } @else {
        <div class="flex flex-col items-center justify-center h-full text-center p-6">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-slate-600 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M12 6V3m0 18v-3" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15a3 3 0 100-6 3 3 0 000 6z" />
          </svg>
          <h3 class="text-xl font-semibold text-slate-300">Output Panel</h3>
          <p class="text-slate-500 mt-2 max-w-sm">
            Your generated RTL code, testbenches, and other documents will appear here.
          </p>
        </div>
      }
    </div>
  </div>
</main>
